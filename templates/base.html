<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Toolshed App{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <nav class="nav">
            <div class="nav-brand">
                <a href="{{ url_for('index') }}">
                    <span class="brand-icon">‚öô</span>
                    <span class="brand-text">TOOLSHED</span>
                </a>
            </div>
            <div class="nav-links">
                <a href="{{ url_for('tools') }}" class="nav-link">Tools</a>
                <a href="{{ url_for('consumables') }}" class="nav-link">Consumables</a>
                <a href="{{ url_for('fasteners') }}" class="nav-link">Fasteners</a>
                <a href="{{ url_for('materials') }}" class="nav-link">Materials</a>
                <a href="{{ url_for('scanner') }}" class="nav-link" style="background: linear-gradient(135deg, var(--accent-blue), var(--accent-cyan)); color: white; padding: 8px 16px; border-radius: 8px; font-weight: 600;">üì± Scan QR</a>
            </div>
        </nav>

        <main class="main-content">
            {% block content %}{% endblock %}
        </main>

        <footer class="footer">
            <p>Toolshed App ‚Ä¢ Tauranga, NZ</p>
        </footer>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Page Load Indicator -->
    <div id="pageLoadIndicator" style="position: fixed; top: 0; left: 0; right: 0; height: 3px; background: linear-gradient(90deg, var(--accent-primary), var(--accent-purple), var(--accent-cyan)); transform: scaleX(0); transform-origin: left; transition: transform 0.3s ease; z-index: 9999;"></div>

    <!-- Toast Notification System -->
    <script>
        // Page Load Indicator
        window.addEventListener('beforeunload', () => {
            document.getElementById('pageLoadIndicator').style.transform = 'scaleX(1)';
        });

        document.addEventListener('DOMContentLoaded', () => {
            const indicator = document.getElementById('pageLoadIndicator');
            indicator.style.transform = 'scaleX(1)';
            setTimeout(() => {
                indicator.style.transform = 'scaleX(0)';
            }, 300);
        });

        // Add loading indicator to all navigation links
        document.addEventListener('click', (e) => {
            const link = e.target.closest('a[href]:not([target="_blank"]):not([onclick])');
            if (link && !link.href.includes('#')) {
                const indicator = document.getElementById('pageLoadIndicator');
                indicator.style.transform = 'scaleX(0.7)';
                indicator.style.transition = 'transform 2s ease';
            }
        });

        function showToast(message, type = 'info', title = '') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;

            const icons = {
                success: '‚úÖ',
                error: '‚ùå',
                warning: '‚ö†Ô∏è',
                info: '‚ÑπÔ∏è'
            };

            const titles = {
                success: title || 'Success',
                error: title || 'Error',
                warning: title || 'Warning',
                info: title || 'Info'
            };

            toast.innerHTML = `
                <div class="toast-icon">${icons[type]}</div>
                <div class="toast-content">
                    <div class="toast-title">${titles[type]}</div>
                    <div class="toast-message">${message}</div>
                </div>
                <button class="toast-close" onclick="closeToast(this)">√ó</button>
            `;

            container.appendChild(toast);

            // Auto-remove after 5 seconds
            setTimeout(() => {
                closeToast(toast.querySelector('.toast-close'));
            }, 5000);
        }

        function closeToast(button) {
            const toast = button.closest('.toast');
            toast.classList.add('removing');
            setTimeout(() => toast.remove(), 300);
        }

        // Show toast from URL parameters (for redirects)
        const urlParams = new URLSearchParams(window.location.search);
        const toastMsg = urlParams.get('toast');
        const toastType = urlParams.get('toast_type') || 'info';
        if (toastMsg) {
            showToast(decodeURIComponent(toastMsg), toastType);
            // Clean URL
            const url = new URL(window.location);
            url.searchParams.delete('toast');
            url.searchParams.delete('toast_type');
            window.history.replaceState({}, '', url);
        }
    </script>

    {% block scripts %}{% endblock %}
</body>
</html>
